<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Samo Admin | The Master Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        /* --- 1. Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØµÙ…ÙŠÙ… (Theming) --- */
        :root {
            --primary: #22c55e;
            --secondary: #3b82f6;
            --danger: #ef4444;
            --warning: #f59e0b;
            --bg: #020617;
            --card: #0f172a;
            --text: #f8fafc;
            --glass: rgba(30, 41, 59, 0.7);
        }

        [data-theme="light"] {
            --bg: #f1f5f9;
            --card: #ffffff;
            --text: #0f172a;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; transition: background 0.3s; }
        body { background: var(--bg); color: var(--text); overflow-x: hidden; }

        /* --- 2. Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ© --- */
        #loginScreen { position: fixed; inset: 0; background: var(--bg); z-index: 5000; display: flex; justify-content: center; align-items: center; }
        .login-box { background: var(--card); padding: 40px; border-radius: 30px; border: 1px solid var(--primary); text-align: center; width: 90%; max-width: 400px; box-shadow: 0 0 50px rgba(34, 197, 94, 0.2); }

        /* --- 3. Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (Layout) --- */
        .admin-wrapper { max-width: 1200px; margin: auto; padding: 20px; display: none; }
        
        header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; flex-wrap: wrap; gap: 15px; }
        .header-title h1 { font-size: 24px; color: var(--primary); }

        /* --- 4. Ø¨Ø§Ø± Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª (Stats Cards) --- */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin-bottom: 30px; }
        .stat-card { background: var(--card); padding: 20px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.05); position: relative; overflow: hidden; }
        .stat-card i { position: absolute; left: -10px; bottom: -10px; font-size: 60px; opacity: 0.1; color: var(--primary); }
        .stat-card h4 { font-size: 13px; color: #94a3b8; }
        .stat-card .val { font-size: 28px; font-weight: 900; color: var(--primary); display: block; margin-top: 5px; }

        /* --- 5. Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ­ÙƒÙ… (Search & Tools) --- */
        .tools-bar { display: grid; grid-template-columns: 2fr 1fr; gap: 15px; margin-bottom: 20px; }
        .search-area { position: relative; }
        .search-area i { position: absolute; right: 15px; top: 15px; color: var(--primary); }
        .search-area input { width: 100%; padding: 14px 45px; background: var(--card); border: 1px solid rgba(255,255,255,0.1); border-radius: 15px; color: white; outline: none; }

        .btn-tool { padding: 10px 15px; border-radius: 12px; border: none; cursor: pointer; font-weight: bold; font-size: 12px; display: flex; align-items: center; gap: 8px; }
        .btn-export { background: var(--secondary); color: white; }
        .btn-theme { background: var(--card); color: var(--text); border: 1px solid rgba(255,255,255,0.1); }

        /* --- 6. Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø°ÙƒÙŠ (Responsive Table) --- */
        .table-section { background: var(--card); border-radius: 20px; border: 1px solid rgba(255,255,255,0.05); overflow: hidden; }
        .table-responsive { width: 100%; overflow-x: auto; -webkit-overflow-scrolling: touch; }
        table { width: 100%; border-collapse: collapse; min-width: 700px; }
        th { padding: 15px; text-align: right; background: rgba(255,255,255,0.02); color: var(--primary); font-size: 13px; }
        td { padding: 15px; border-bottom: 1px solid rgba(255,255,255,0.05); font-size: 14px; white-space: nowrap; }
        .row-item:hover { background: rgba(255,255,255,0.02); cursor: pointer; }

        /* --- 7. Ø§Ù„Ø£ÙˆÙØ±Ù„Ø§ÙŠ Ø§Ù„Ø¹Ù…Ù„Ø§Ù‚ (Master Detail View) --- */
        #masterOverlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); backdrop-filter: blur(10px); z-index: 4000; justify-content: center; align-items: flex-start; padding: 15px; overflow-y: auto; }
        .master-card { background: var(--card); width: 100%; max-width: 600px; border-radius: 30px; border: 1px solid var(--primary); margin: 20px auto; overflow: hidden; animation: popUp 0.3s ease; }
        @keyframes popUp { from { transform: scale(0.9); opacity: 0; } }

        .master-header { padding: 20px; background: var(--primary); color: #000; display: flex; justify-content: space-between; align-items: center; }
        .master-body { padding: 25px; }
        
        .data-box { background: rgba(255,255,255,0.03); padding: 15px; border-radius: 15px; margin-bottom: 15px; position: relative; }
        .data-box label { display: block; font-size: 11px; color: var(--primary); margin-bottom: 5px; }
        .data-box p { font-size: 16px; font-weight: bold; }
        .copy-ico { position: absolute; left: 15px; top: 15px; color: var(--primary); cursor: pointer; }

        .control-group { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px; }
        select { background: #1e293b; color: white; padding: 12px; border-radius: 10px; border: 1px solid var(--primary); outline: none; width: 100%; }

        /* --- 8. Ø³Ø¬Ù„ Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª (Log) --- */
        .log-section { margin-top: 30px; background: #000; padding: 20px; border-radius: 20px; border-left: 4px solid var(--secondary); }
        .log-section h3 { font-size: 14px; margin-bottom: 10px; color: var(--secondary); }
        #activityLog { font-size: 12px; height: 100px; overflow-y: auto; color: #64748b; }

        /* --- 9. Ø§Ù„Ù…ÙŠØ¯ÙŠØ§ ÙƒÙˆÙŠØ±ÙŠ --- */
        @media (max-width: 600px) {
            .tools-bar { grid-template-columns: 1fr; }
            .control-group { grid-template-columns: 1fr; }
            .header-title h1 { font-size: 18px; }
        }
    </style>
</head>
<body>

    <div id="loginScreen">
        <div class="login-box">
            <i class="fas fa-user-shield" style="font-size: 50px; color: var(--primary); margin-bottom: 20px;"></i>
            <h2>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙŠØ§ Ø³ÙŠÙ…Ùˆ</h2>
            <p style="color:#64748b; font-size:12px; margin-bottom:20px;">Ø§Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ù„ÙØªØ­ Ù…Ø±ÙƒØ² Ø§Ù„ØªØ­ÙƒÙ…</p>
            <input type="password" id="passInput" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" style="width:100%; padding:15px; background:#000; border:1px solid #334155; color:white; border-radius:12px; text-align:center; margin-bottom:15px; outline:none;">
            <button onclick="accessAdmin()" style="width:100%; padding:15px; background:var(--primary); border:none; border-radius:12px; font-weight:900; cursor:pointer;">ÙØªØ­ Ø§Ù„Ù„ÙˆØ­Ø©</button>
        </div>
    </div>

    <div class="admin-wrapper" id="adminMain">
        <header>
            <div class="header-title">
                <h1>Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø³ÙŠÙ…Ùˆ Ø§Ù„Ø¹Ø¨Ù‚Ø±ÙŠ <i class="fas fa-bolt"></i></h1>
            </div>
            <div style="display:flex; gap:10px;">
                <button class="btn-tool btn-theme" onclick="toggleTheme()"><i class="fas fa-moon"></i></button>
                <button class="btn-tool" style="background:var(--danger); color:white;" onclick="location.reload()">Ø®Ø±ÙˆØ¬</button>
            </div>
        </header>

        <div class="stats-grid">
            <div class="stat-card"><i class="fas fa-user-graduate"></i><h4>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø§Ø¨</h4><span class="val" id="s_total">0</span></div>
            <div class="stat-card"><i class="fas fa-coins"></i><h4>Ø£Ø±Ø¨Ø§Ø­Ùƒ (Ø¬.Ù…)</h4><span class="val" id="s_money">0</span></div>
            <div class="stat-card"><i class="fas fa-check-circle"></i><h4>ØªÙ… ØªÙ†ÙÙŠØ°Ù‡Ù…</h4><span class="val" id="s_done">0</span></div>
            <div class="stat-card"><i class="fas fa-school"></i><h4>Ø§Ù„Ù…Ø¯Ø§Ø±Ø³</h4><span class="val" id="s_schools">0</span></div>
        </div>

        <div class="tools-bar">
            <div class="search-area">
                <i class="fas fa-search"></i>
                <input type="text" id="searchInput" onkeyup="searchSystem()" placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù…ØŒ Ø§Ù„ÙƒÙˆØ¯ØŒ Ø£Ùˆ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©...">
            </div>
            <div style="display:flex; gap:10px;">
                <button class="btn-tool btn-export" onclick="downloadData()"><i class="fas fa-download"></i> ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
            </div>
        </div>

        <div class="table-section">
            <div class="table-responsive">
                <table>
                    <thead>
                        <tr>
                            <th># Ø§Ù„Ø¯ÙˆØ±</th>
                            <th>Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</th>
                            <th>Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</th>
                            <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                            <th>Ø§Ù„Ø¯ÙØ¹</th>
                            <th>Ø¥Ø¬Ø±Ø§Ø¡</th>
                        </tr>
                    </thead>
                    <tbody id="tbody"></tbody>
                </table>
            </div>
        </div>

        <div class="log-section">
            <h3><i class="fas fa-history"></i> Ø³Ø¬Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø³Ø±ÙŠØ¹Ø©</h3>
            <div id="activityLog"></div>
        </div>
    </div>

    <div id="masterOverlay">
        <div class="master-card">
            <div class="master-header">
                <h3>Ù…Ù„Ù Ø§Ù„Ø·Ø§Ù„Ø¨: <span id="m_title"></span></h3>
                <i class="fas fa-times-circle" onclick="closeMaster()" style="cursor:pointer; font-size:25px;"></i>
            </div>
            <div class="master-body">
                <div class="data-box">
                    <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
                    <p id="m_name"></p>
                </div>
                <div class="data-box">
                    <label>Ø§Ù„Ù…Ø¯Ø±Ø³Ø© ÙˆØ§Ù„ÙØµÙ„</label>
                    <p id="m_school_class"></p>
                </div>
                <div class="data-box">
                    <label>ÙƒÙˆØ¯ Ø§Ù„Ø·Ø§Ù„Ø¨ (Ø§Ù„Ù…Ù†ØµØ©)</label>
                    <p id="m_pcode"></p>
                    <i class="fas fa-copy copy-ico" onclick="copyValue('m_pcode')"></i>
                </div>
                <div class="data-box">
                    <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± (Ø§Ù„Ù…Ù†ØµØ©)</label>
                    <p id="m_ppass"></p>
                    <i class="fas fa-copy copy-ico" onclick="copyValue('m_ppass')"></i>
                </div>
                <div class="data-box">
                    <label>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯ÙØ¹ ÙˆØ§Ù„ØªØ­ÙˆÙŠÙ„</label>
                    <p id="m_pay_details"></p>
                </div>
                <div class="data-box">
                    <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø¬Ø²</label>
                    <p id="m_date"></p>
                </div>

                <div class="control-group">
                    <div>
                        <label style="font-size:11px; color:var(--primary)">Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨:</label>
                        <select id="m_status_sel">
                            <option value="ØªÙ… Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…">â³ ØªÙ… Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…</option>
                            <option value="Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¹Ù…Ù„">ğŸ› ï¸ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¹Ù…Ù„</option>
                            <option value="ØªÙ… Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡">âœ… ØªÙ… Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡</option>
                            <option value="Ù…Ø±ÙÙˆØ¶">âŒ Ù…Ø±ÙÙˆØ¶</option>
                        </select>
                    </div>
                    <div>
                        <label style="font-size:11px; color:var(--primary)">Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙØ¹:</label>
                        <select id="m_pay_sel">
                            <option value="Ù„Ù… ÙŠØ¯ÙØ¹">ğŸ”´ Ù„Ù… ÙŠØ¯ÙØ¹</option>
                            <option value="ØªÙ… Ø§Ù„Ø¯ÙØ¹">ğŸŸ¢ ØªÙ… Ø§Ù„Ø¯ÙØ¹</option>
                        </select>
                    </div>
                </div>
                
                <div style="display:grid; grid-template-columns: 1fr 2fr; gap:10px; margin-top:20px;">
                    <button class="btn-tool" style="background:var(--danger); color:white; justify-content:center;" onclick="deleteData()">Ø­Ø°Ù Ø§Ù„Ø­Ø¬Ø²</button>
                    <button class="btn-tool" style="background:var(--primary); color:#000; justify-content:center;" onclick="saveMaster()">Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let db = [];
        let editIdx = null;

        // Ø§Ù„Ø¯Ø®ÙˆÙ„
        function accessAdmin() {
            if(document.getElementById('passInput').value === "Mody1234m@") {
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('adminMain').style.display = 'block';
                refreshData();
                addLog("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­");
            } else { alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± ØºÙ„Ø· ÙŠØ§ Ø³ÙŠÙ…Ùˆ!"); }
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        function refreshData() {
            db = JSON.parse(localStorage.getItem('samo_db') || '[]');
            const tbody = document.getElementById('tbody');
            tbody.innerHTML = '';
            
            let money = 0;
            let done = 0;
            let schools = new Set();

            db.forEach((item, i) => {
                if(item.pay_status === 'ØªÙ… Ø§Ù„Ø¯ÙØ¹') money += 50;
                if(item.status === 'ØªÙ… Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡') done++;
                schools.add(item.school);

                tbody.innerHTML += `
                    <tr class="row-item" onclick="openMaster(${i})">
                        <td style="color:var(--primary); font-weight:bold;">#${item.id}</td>
                        <td>${item.name}</td>
                        <td>${item.school}</td>
                        <td><span style="font-size:11px; background:rgba(255,255,255,0.05); padding:4px 8px; border-radius:5px;">${item.status}</span></td>
                        <td><i class="fas fa-circle" style="color:${item.pay_status === 'ØªÙ… Ø§Ù„Ø¯ÙØ¹' ? 'var(--primary)' : 'var(--danger)'}; font-size:8px;"></i> ${item.pay_status}</td>
                        <td><button class="btn-tool" style="background:var(--primary); color:#000; padding:5px 10px;">ØªØ­ÙƒÙ…</button></td>
                    </tr>
                `;
            });

            document.getElementById('s_total').innerText = db.length;
            document.getElementById('s_money').innerText = money;
            document.getElementById('s_done').innerText = done;
            document.getElementById('s_schools').innerText = schools.size;
        }

        // ÙØªØ­ Ø§Ù„Ø£ÙˆÙØ±Ù„Ø§ÙŠ
        function openMaster(idx) {
            editIdx = idx;
            const item = db[idx];
            document.getElementById('m_title').innerText = item.name.split(' ')[0];
            document.getElementById('m_name').innerText = item.name;
            document.getElementById('m_school_class').innerText = item.school + " (" + item.class + ")";
            document.getElementById('m_pcode').innerText = item.pcode;
            document.getElementById('m_ppass').innerText = item.ppass;
            document.getElementById('m_pay_details').innerText = item.method + " | " + (item.pay_ph || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø±Ù‚Ù…');
            document.getElementById('m_date').innerText = item.date || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
            document.getElementById('m_status_sel').value = item.status;
            document.getElementById('m_pay_sel').value = item.pay_status;
            
            document.getElementById('masterOverlay').style.display = 'flex';
        }

        function closeMaster() { document.getElementById('masterOverlay').style.display = 'none'; }

        // Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª
        function saveMaster() {
            db[editIdx].status = document.getElementById('m_status_sel').value;
            db[editIdx].pay_status = document.getElementById('m_pay_sel').value;
            localStorage.setItem('samo_db', JSON.stringify(db));
            addLog(`ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨: ${db[editIdx].name}`);
            closeMaster();
            refreshData();
        }

        // Ø­Ø°Ù
        function deleteData() {
            if(confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø­Ø°Ù Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØŸ")) {
                addLog(`ØªÙ… Ø­Ø°Ù Ø§Ù„Ø·Ø§Ù„Ø¨: ${db[editIdx].name}`);
                db.splice(editIdx, 1);
                localStorage.setItem('samo_db', JSON.stringify(db));
                closeMaster();
                refreshData();
            }
        }

        // Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø°ÙƒÙŠ
        function searchSystem() {
            const val = document.getElementById('searchInput').value.toLowerCase();
            const rows = document.querySelectorAll('#tbody tr');
            rows.forEach(row => {
                row.style.display = row.innerText.toLowerCase().includes(val) ? '' : 'none';
            });
        }

        // Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ (ØªØµØ¯ÙŠØ±)
        function downloadData() {
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(db));
            const downloadAnchorNode = document.createElement('a');
            downloadAnchorNode.setAttribute("href", dataStr);
            downloadAnchorNode.setAttribute("download", "samo_backup_" + new Date().toLocaleDateString() + ".json");
            document.body.appendChild(downloadAnchorNode);
            downloadAnchorNode.click();
            downloadAnchorNode.remove();
            addLog("ØªÙ… ØªØµØ¯ÙŠØ± Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
        }

        // Ø³Ø¬Ù„ Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª
        function addLog(msg) {
            const logBox = document.getElementById('activityLog');
            const time = new Date().toLocaleTimeString();
            logBox.innerHTML = `<div>[${time}] ${msg}</div>` + logBox.innerHTML;
        }

        // Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ
        function toggleTheme() {
            const body = document.body;
            const theme = body.getAttribute('data-theme');
            if(theme === 'light') {
                body.removeAttribute('data-theme');
                addLog("ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ");
            } else {
                body.setAttribute('data-theme', 'light');
                addLog("ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù†Ù‡Ø§Ø±ÙŠ");
            }
        }

        // Ù†Ø³Ø® Ø§Ù„Ù‚ÙŠÙ… Ø¨Ø¶ØºØ·Ø© ÙˆØ§Ø­Ø¯Ø©
        function copyValue(id) {
            const text = document.getElementById(id).innerText;
            navigator.clipboard.writeText(text);
            alert("ØªÙ… Ù†Ø³Ø®: " + text);
        }
    </script>
</body>
                    </html>
                    
