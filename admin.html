<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Samo Admin | Master Control</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* --- Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ§Øª ÙˆØ§Ù„Ø£Ù†ÙŠÙ…ÙŠØ´Ù† --- */
        :root {
            --primary: #22c55e;
            --accent: #3b82f6;
            --bg: #020617;
            --card: #0f172a;
            --text: #f8fafc;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; }
        body { background: var(--bg); color: var(--text); padding: 20px; }

        /* --- Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ --- */
        #loginScreen { position: fixed; inset: 0; background: var(--bg); z-index: 2000; display: flex; justify-content: center; align-items: center; }
        .login-box { background: var(--card); padding: 40px; border-radius: 25px; border: 1px solid var(--primary); text-align: center; }

        /* --- Ø§Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© --- */
        .admin-container { max-width: 1200px; margin: auto; display: none; animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .stats-bar { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 30px; }
        .stat-item { background: var(--card); padding: 20px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.05); text-align: center; }
        .stat-item h4 { color: #94a3b8; font-size: 13px; }
        .stat-item span { font-size: 24px; font-weight: 900; color: var(--primary); }

        /* --- Ø§Ù„Ø¬Ø¯ÙˆÙ„ --- */
        .table-wrapper { background: var(--card); border-radius: 20px; overflow: hidden; border: 1px solid rgba(255,255,255,0.05); }
        table { width: 100%; border-collapse: collapse; text-align: right; }
        th { background: rgba(255,255,255,0.02); padding: 15px; font-size: 13px; color: var(--primary); }
        td { padding: 15px; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .row-item:hover { background: rgba(34, 197, 94, 0.03); cursor: pointer; }

        /* --- Ø´Ø§Ø´Ø© Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙƒØ¨ÙŠØ±Ø© (The Full Overlay) --- */
        #detailsOverlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.9);
            backdrop-filter: blur(15px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .details-card {
            background: var(--card);
            width: 100%;
            max-width: 800px;
            border-radius: 30px;
            border: 1px solid var(--primary);
            overflow: hidden;
            animation: slideUp 0.4s cubic-bezier(0.18, 0.89, 0.32, 1.28);
        }

        @keyframes slideUp { from { transform: translateY(100px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        .details-header { background: var(--primary); color: #000; padding: 20px; display: flex; justify-content: space-between; align-items: center; }
        .details-body { padding: 30px; display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; }
        
        .data-group { background: rgba(255,255,255,0.03); padding: 15px; border-radius: 15px; position: relative; }
        .data-group label { display: block; font-size: 11px; color: var(--primary); margin-bottom: 5px; }
        .data-group p { font-size: 16px; font-weight: bold; }
        
        .copy-btn { position: absolute; left: 10px; top: 15px; background: var(--primary); color: #000; border: none; padding: 5px 10px; border-radius: 8px; font-size: 11px; cursor: pointer; font-weight: bold; }

        .status-changer { margin-top: 20px; display: flex; gap: 10px; align-items: center; }
        .status-select { background: #1e293b; color: white; border: 1px solid var(--primary); padding: 10px; border-radius: 10px; outline: none; flex: 1; }

        .action-footer { padding: 20px; background: rgba(0,0,0,0.2); display: flex; justify-content: space-between; }
        .btn { padding: 12px 25px; border-radius: 12px; border: none; cursor: pointer; font-weight: bold; }
        .btn-save { background: var(--primary); color: #000; }
        .btn-del { background: #ef4444; color: white; }
    </style>
</head>
<body>

    <div id="loginScreen">
        <div class="login-box">
            <i class="fas fa-fingerprint" style="font-size: 50px; color: var(--primary); margin-bottom: 15px;"></i>
            <h3>Samo Control Panel</h3>
            <input type="password" id="adminPass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" style="width:100%; padding:12px; margin:15px 0; background:#000; border:1px solid #334155; color:white; border-radius:10px; text-align:center;">
            <button onclick="checkAdmin()" style="width:100%; padding:12px; background:var(--primary); border:none; border-radius:10px; font-weight:bold; cursor:pointer;">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù†Ø¸Ø§Ù…</button>
        </div>
    </div>

    <div class="admin-container" id="adminPanel">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:30px;">
            <h2>Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø³ÙŠÙ…Ùˆ Ø§Ù„Ø¹Ø¨Ù‚Ø±ÙŠ <i class="fas fa-crown" style="color:gold"></i></h2>
            <button onclick="logout()" style="background:none; border:none; color:#ef4444; cursor:pointer;"><i class="fas fa-sign-out-alt"></i> Ø®Ø±ÙˆØ¬</button>
        </div>

        <div class="stats-bar">
            <div class="stat-item"><h4>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h4><span id="s_total">0</span></div>
            <div class="stat-item"><h4>Ø£Ø±Ø¨Ø§Ø­ Ù…ØªÙˆÙ‚Ø¹Ø©</h4><span id="s_money">0</span></div>
            <div class="stat-item"><h4>ØªÙ… Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡</h4><span id="s_done">0</span></div>
        </div>

        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th>Ø±Ù‚Ù… Ø§Ù„Ø¯ÙˆØ±</th>
                        <th>Ø§Ù„Ø§Ø³Ù…</th>
                        <th>Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</th>
                        <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                        <th>Ø¥Ø¬Ø±Ø§Ø¡</th>
                    </tr>
                </thead>
                <tbody id="tbody"></tbody>
            </table>
        </div>
    </div>

    <div id="detailsOverlay">
        <div class="details-card">
            <div class="details-header">
                <h3>ØªÙØ§ØµÙŠÙ„ Ø­Ø¬Ø²: <span id="det_name_title"></span></h3>
                <i class="fas fa-times" onclick="closeDetails()" style="cursor:pointer; font-size:20px;"></i>
            </div>
            <div class="details-body">
                <div class="data-group">
                    <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
                    <p id="det_name"></p>
                </div>
                <div class="data-group">
                    <label>Ø§Ù„Ù…Ø¯Ø±Ø³Ø© ÙˆØ§Ù„ÙØµÙ„</label>
                    <p id="det_school_class"></p>
                </div>
                <div class="data-group">
                    <label>ÙƒÙˆØ¯ Ø§Ù„Ù…Ù†ØµØ©</label>
                    <p id="det_pcode"></p>
                    <button class="copy-btn" onclick="copyText('det_pcode')">Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯</button>
                </div>
                <div class="data-group">
                    <label>Ø¨Ø§Ø³ÙˆØ±Ø¯ Ø§Ù„Ù…Ù†ØµØ©</label>
                    <p id="det_ppass"></p>
                    <button class="copy-btn" onclick="copyText('det_ppass')">Ù†Ø³Ø® Ø§Ù„Ø¨Ø§Ø³ÙˆØ±Ø¯</button>
                </div>
                <div class="data-group">
                    <label>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹ ÙˆØ¨ÙŠØ§Ù†Ø§ØªÙ‡</label>
                    <p id="det_pay_info"></p>
                </div>
                <div class="data-group">
                    <label>ØªØ§Ø±ÙŠØ® ÙˆÙˆÙ‚Øª Ø§Ù„Ø­Ø¬Ø²</label>
                    <p id="det_time"></p>
                </div>

                <div class="data-group" style="grid-column: span 2;">
                    <label>ØªØºÙŠÙŠØ± Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø¬Ø²</label>
                    <div class="status-changer">
                        <select id="newStatus" class="status-select">
                            <option value="ØªÙ… Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…">â³ ØªÙ… Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…</option>
                            <option value="Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¹Ù…Ù„">ğŸ› ï¸ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¹Ù…Ù„</option>
                            <option value="ØªÙ… Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡">âœ… ØªÙ… Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡</option>
                            <option value="Ù…Ø±ÙÙˆØ¶">âŒ Ù…Ø±ÙÙˆØ¶</option>
                        </select>
                        <select id="newPayStatus" class="status-select">
                            <option value="Ù„Ù… ÙŠØ¯ÙØ¹">ğŸ”´ Ù„Ù… ÙŠØ¯ÙØ¹</option>
                            <option value="ØªÙ… Ø§Ù„Ø¯ÙØ¹">ğŸŸ¢ ØªÙ… Ø§Ù„Ø¯ÙØ¹</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="action-footer">
                <button class="btn btn-del" onclick="deleteCurrent()">Ø­Ø°Ù Ø§Ù„Ø­Ø¬Ø² Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹</button>
                <button class="btn btn-save" onclick="saveChanges()">Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</button>
            </div>
        </div>
    </div>

    <script>
        let currentDB = [];
        let editingIndex = null;

        function checkAdmin() {
            if(document.getElementById('adminPass').value === "Mody1234m@") {
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'block';
                loadData();
            } else { alert("ØºÙ„Ø· ÙŠØ§ ÙˆØ­Ø´!"); }
        }

        function loadData() {
            currentDB = JSON.parse(localStorage.getItem('samo_db') || '[]');
            const tbody = document.getElementById('tbody');
            tbody.innerHTML = '';
            
            let money = 0;
            let done = 0;

            currentDB.forEach((item, i) => {
                if(item.pay_status === 'ØªÙ… Ø§Ù„Ø¯ÙØ¹') money += 50;
                if(item.status === 'ØªÙ… Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡') done++;

                tbody.innerHTML += `
                    <tr class="row-item" onclick="openDetails(${i})">
                        <td style="font-weight:bold; color:var(--primary)">#${item.id}</td>
                        <td>${item.name}</td>
                        <td>${item.school}</td>
                        <td><span style="font-size:11px; padding:5px; background:rgba(255,255,255,0.05); border-radius:5px;">${item.status}</span></td>
                        <td><button style="background:var(--accent); border:none; padding:5px 10px; border-radius:5px; color:white; font-size:10px;">Ø¹Ø±Ø¶ ÙˆØªØ­ÙƒÙ…</button></td>
                    </tr>
                `;
            });

            document.getElementById('s_total').innerText = currentDB.length;
            document.getElementById('s_money').innerText = money + " Ø¬.Ù…";
            document.getElementById('s_done').innerText = done;
        }

        function openDetails(index) {
            editingIndex = index;
            const item = currentDB[index];
            document.getElementById('det_name_title').innerText = item.name;
            document.getElementById('det_name').innerText = item.name;
            document.getElementById('det_school_class').innerText = item.school + " - " + item.class;
            document.getElementById('det_pcode').innerText = item.pcode;
            document.getElementById('det_ppass').innerText = item.ppass;
            document.getElementById('det_pay_info').innerText = item.method + " (" + (item.pay_ph || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯') + ")";
            document.getElementById('det_time').innerText = item.date || 'ØºÙŠØ± Ù…Ø³Ø¬Ù„';
            document.getElementById('newStatus').value = item.status;
            document.getElementById('newPayStatus').value = item.pay_status;
            
            document.getElementById('detailsOverlay').style.display = 'flex';
        }

        function closeDetails() { document.getElementById('detailsOverlay').style.display = 'none'; }

        function saveChanges() {
            currentDB[editingIndex].status = document.getElementById('newStatus').value;
            currentDB[editingIndex].pay_status = document.getElementById('newPayStatus').value;
            localStorage.setItem('samo_db', JSON.stringify(currentDB));
            closeDetails();
            loadData();
            alert("ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¨Ù†Ø¬Ø§Ø­!");
        }

        function deleteCurrent() {
            if(confirm("Ù‡ØªÙ…Ø³Ø­Ù‡ Ø®Ø§Ù„ØµØŸ")) {
                currentDB.splice(editingIndex, 1);
                localStorage.setItem('samo_db', JSON.stringify(currentDB));
                closeDetails();
                loadData();
            }
        }

        function copyText(id) {
            const text = document.getElementById(id).innerText;
            navigator.clipboard.writeText(text);
            alert("ØªÙ… Ø§Ù„Ù†Ø³Ø®: " + text);
        }

        function logout() { window.location.reload(); }
    </script>
</body>
</html>
